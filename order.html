<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="icon" type="image/x-icon" href="images/Logo.png"/>
    <title>Order - WB Bouquet Shop</title>
    <!-- Memuat Tailwind CSS untuk styling (diperlukan oleh komponen upload) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Memuat Font Awesome -->
    <script src="https://kit.fontawesome.com/9462eee823.js" crossorigin="anonymous"></script>
    <!-- Memuat Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
    <style>
        /* Variabel Warna Tema */
        :root {
            --primary: #240046;
            --secondary: #3c096c;
            --accent: #5a189a;
            --light: #f8f9fa;
            --light-gray: #eaeaea;
            --medium-gray: #d0d0d0;
            --dark: #212529;
            --text: #333333;
            --text-light: #666666;
            --white: #ffffff;
            --pink: #ff5d8f;
            --light-pink: #ffafcc;
            --border-focus-color: #4A90E2;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --error-text-color: #c53030;
            --error-border-color: #fc8181;
            --error-bg: #fff5f5;
        }

        /* Reset & Global */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: "Inter", sans-serif;
            background-color: var(--light);
            color: var(--text);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            scroll-behavior: smooth;
        }

        /* Animasi Transisi Halaman */
        @keyframes page-load-animation {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        body {
            animation: page-load-animation 0.5s ease-out;
        }

        /* Header & Navigasi */
        .header {
            background-color: var(--white);
            padding: 0 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .navbar {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo_brand {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            font-weight: 600;
            text-decoration: none;
            color: var(--accent);
        }

        .logo_brand img {
            height: 45px;
            width: 45px;
            border-radius: 50%;
        }

        .nav-links {
            list-style-type: none;
            display: flex;
            gap: 15px;
        }

        .nav-links a {
            color: var(--text);
            text-decoration: none;
            padding: 8px 12px;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            font-size: 0.95rem;
            border-radius: 6px;
            display: flex;
            align-items: center;
            position: relative;
            gap: 6px;
        }

        .nav-links a:hover {
            background-color: rgba(36, 0, 70, 0.05);
        }

        .nav-links a.active {
            background-color: var(--accent);
            color: var(--white) !important;
        }

        /* Main Content & Form Container */
        main {
            padding: 3rem 1rem;
        }

        .form-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: var(--white);
            border-radius: 12px;
            box-shadow: 0 5px 15px var(--shadow-color);
            padding: 2.5rem;
        }

        .form-header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        .form-header h1 {
            color: var(--primary);
            font-size: 2rem;
            font-weight: 700;
        }

        .form-header p {
            color: var(--text-light);
            margin-top: 0.5rem;
        }

        /* Form Styling */
        .form-grid-wrapper {
            display: flex;
            flex-direction: column;
            gap: 1.5rem; /* Reduced gap */
        }

        .form-grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-col-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-col-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: relative;
        }

        .form-group label {
            font-weight: 500;
            color: var(--text);
            font-size: 0.9rem;
        }

        .input-field, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--medium-gray, #ccc);
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background-color: var(--light);
            transition: all 0.2s ease;
        }

        .input-field:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(90, 24, 154, 0.15);
        }

        /* Input Group with Prefix */
        .input-group {
            display: flex;
            align-items: center;
        }

        .input-group .prefix {
            padding: 0 15px;
            color: var(--text-light);
            font-weight: 500;
            border: 1px solid var(--medium-gray);
            border-right: none;
            border-radius: 8px 0 0 8px;
            height: 49px; /* match input height */
            display: flex;
            align-items: center;
            background-color: var(--light-gray);
        }

        .input-group .input-field {
            border-radius: 0 8px 8px 0;
            border-left: none;
        }

        .input-group.input-error .prefix, .input-error {
            border-color: var(--error-border-color) !important;
        }

        .input-field.input-error:focus, .input-group:has(.input-field.input-error:focus) {
            border-color: var(--error-border-color) !important;
            box-shadow: 0 0 0 3px var(--error-bg) !important;
        }

        /* Menghilangkan panah pada input number */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }

        /* Image Upload Area */
        #drop-zone {
            cursor: pointer;
        }

        .preview-item {
            position: relative;
            width: 100%;
            padding-top: 100%; /* 1:1 Aspect Ratio */
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .preview-img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .delete-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 28px;
            height: 28px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 10;
        }

        .preview-item:hover .delete-btn {
            opacity: 1;
        }


        /* Radio Options */
        .radio-options-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .radio-label {
            display: flex;
            align-items: center;
            padding: 1rem;
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .radio-label:has(input:checked) {
            background-color: #f9f2ff;
            border-color: var(--accent);
        }

        .radio-label input {
            display: none;
        }

        .radio-label .custom-radio {
            width: 20px;
            height: 20px;
            border: 2px solid var(--medium-gray);
            border-radius: 50%;
            margin-right: 0.5rem;
            display: grid;
            place-items: center;
            transition: border-color 0.3s ease;
        }

        .radio-label .custom-radio::before {
            content: '';
            width: 10px;
            height: 10px;
            background-color: var(--accent);
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.2s ease-in-out;
        }

        .radio-label input:checked + .custom-radio {
            border-color: var(--accent);
        }

        .radio-label input:checked + .custom-radio::before {
            transform: scale(1);
        }

        .radio-label .icon {
            margin-right: 0.5rem;
            color: var(--text-light);
            transition: color 0.3s ease;
        }

        .radio-label:has(input:checked) .icon {
            color: var(--accent);
        }

        /* Buttons */
        .btn {
            padding: 14px 28px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1rem;
            text-decoration: none;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(36, 0, 70, 0.2);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(36, 0, 70, 0.3);
        }

        /* Inline Error Message */
        .error-message {
            color: var(--error-text-color);
            font-size: 0.8rem;
            margin-top: -4px;
            display: none;
        }

        /* Footer */
        footer {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: var(--white);
            padding: 60px 20px 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .footer-column h3 {
            font-size: 1.3rem;
            margin-bottom: 25px;
            font-weight: 600;
            color: var(--white);
            position: relative;
            padding-bottom: 10px;
        }

        .footer-column h3:after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background: var(--white);
            border-radius: 2px;
        }

        .footer-links {
            list-style-type: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 15px;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }

        .footer-links a:hover {
            color: var(--white);
            transform: translateX(5px);
        }

        .copyright {
            text-align: center;
            padding-top: 40px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.95rem;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            color: var(--white);
            font-size: 1.1rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .social-links a:hover {
            background-color: var(--light-pink);
            color: var(--primary);
            transform: translateY(-5px);
        }

        @media (max-width: 768px) {
            .grid-col-2, .grid-col-3 {
                grid-template-columns: 1fr;
            }

            .navbar {
                flex-direction: column;
                height: auto;
                padding: 1rem;
                gap: 15px;
            }
        }
    </style>
</head>
<body>

<!-- Header/Navbar -->
<header class="header">
    <nav class="navbar">
        <a href="index.html" class="logo_brand">
            <img src="images/Logo.png" alt="Logo"/>
            <span>Wiwid Beauty | Bouquet Shop</span>
        </a>
        <ul class="nav-links">
            <li><a href="index.html"><i class="fa-solid fa-house"></i>Beranda</a></li>
            <li><a href="order.html" class="active"><i class="fa-solid fa-envelope"></i>Order</a></li>
            <li><a href="produk.html"> <i class="fa-solid fa-store"></i>Produk </a></li>
            <li><a href="keranjang.html"><i class="fa-solid fa-cart-shopping"></i>Keranjang</a></li>
        </ul>
    </nav>
</header>

<!-- Main Content (Formulir) -->
<main>
    <div class="form-container">

        <div class="form-header">
            <h1>Formulir Pemesanan</h1>
            <p>Silakan isi detail pesanan Anda di bawah ini.</p>
        </div>

        <form id="orderForm" novalidate>
            <div class="form-grid-wrapper">
                <!-- SEKSI 1: Info Pemesan -->
                <div class="form-grid grid-col-2">
                    <div class="form-group">
                        <label for="fullName">Nama Lengkap</label>
                        <input type="text" id="fullName" name="fullName" class="input-field"
                               placeholder="Contoh: Budi Santoso" required oninput="capitalizeName(this)">
                        <p class="error-message" id="fullName-error"></p>
                    </div>
                    <div class="form-group">
                        <label for="whatsappNumber">Nomor WhatsApp</label>
                        <div class="input-group" id="whatsapp-group">
                            <span class="prefix">+62</span>
                            <input type="tel" id="whatsappNumber" name="whatsappNumber" class="input-field"
                                   placeholder="812-3456-7890" required oninput="formatPhoneNumber(this)"
                                   maxlength="15">
                        </div>
                        <p class="error-message" id="whatsappNumber-error"></p>
                    </div>
                </div>

                <!-- SEKSI 2: Jenis Pesanan -->
                <div class="form-grid grid-col-2">
                    <div class="form-group">
                        <label for="kategori_barang">Kategori Produk</label>
                        <select id="kategori_barang" name="kategori_barang" class="input-field" required>
                            <option value="" disabled selected>Pilih Kategori</option>
                            <option value="Buket Bunga">Buket Bunga</option>
                            <option value="Buket Balon">Buket Balon</option>
                            <option value="Hampers">Hampers</option>
                        </select>
                        <p class="error-message" id="kategori_barang-error"></p>
                    </div>
                    <div class="form-group" id="jenis_buket_group">
                        <label for="jenis_buket">Jenis Produk</label>
                        <select id="jenis_buket" name="jenis_buket" class="input-field" required>
                            <option value="" disabled selected>Pilih Jenis</option>
                        </select>
                        <p class="error-message" id="jenis_buket-error"></p>
                    </div>
                </div>

                <!-- SEKSI 3: Kustomisasi -->
                <div class="form-grid grid-col-3">
                    <div class="form-group">
                        <label for="jumlah_pesanan">Jumlah</label>
                        <input type="number" id="jumlah_pesanan" name="jumlah_pesanan" class="input-field" min="1"
                               value="1" required>
                        <p class="error-message" id="jumlah_pesanan-error"></p>
                    </div>
                    <div class="form-group" id="nuansa_warna_group">
                        <label for="nuansa_warna">Nuansa Warna</label>
                        <input type="text" id="nuansa_warna" name="nuansa_warna" class="input-field"
                               placeholder="Contoh: Pastel, Earth tone">
                    </div>
                    <div class="form-group" id="ukuran_group">
                        <label for="ukuran">Ukuran</label>
                        <select id="ukuran" name="ukuran" class="input-field" required>
                            <option value="" disabled selected>Pilih Ukuran</option>
                            <option value="Small">Small</option>
                            <option value="Medium">Medium</option>
                            <option value="Large">Large</option>
                        </select>
                        <p class="error-message" id="ukuran-error"></p>
                    </div>
                </div>

                <!-- SEKSI 4: Budget & Tanggal -->
                <div class="form-grid grid-col-2">
                    <div class="form-group">
                        <label for="harga_mulai">Harga Mulai Dari</label>
                        <select id="harga_mulai" name="harga_mulai" class="input-field" required>
                            <option value="" disabled selected>Pilih Kategori Harga</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tanggal-acara">Untuk Tanggal Berapa</label>
                        <input type="date" name="tanggal-acara" id="tanggal-acara" class="input-field" required>
                        <p class="error-message" id="tanggal-acara-error"></p>
                    </div>
                </div>

                <!-- SEKSI 5: Unggah Foto -->
                <div class="form-group">
                    <label>Unggah Foto Referensi <span class="font-normal text-gray-400">(Bisa dilihat di Beranda / Instagram @Wiwidbeauty)</span></label>
                    <label for="file-upload" id="drop-zone"
                           class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg transition-colors duration-300 cursor-pointer">
                        <div id="upload-prompt" class="space-y-1 text-center pointer-events-none">
                            <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none"
                                 viewBox="0 0 48 48" aria-hidden="true">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8"
                                      stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <div class="flex text-sm text-gray-600 justify-center">
                                <span class="relative bg-white rounded-md font-medium text-gray-600">
                                    <span>Pilih file</span>
                                </span>
                                <p class="pl-1">atau tarik dan lepas</p>
                            </div>
                            <p class="text-xs text-gray-500">PNG, JPG, GIF hingga 10MB</p>
                        </div>
                    </label>
                    <input id="file-upload" name="file-upload" type="file" class="sr-only" multiple accept="image/*">
                    <div id="preview-container" class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>
                </div>

                <!-- SEKSI 6: Pengiriman & Catatan -->
                <div class="form-group">
                    <label>Opsi Pengambilan</label>
                    <div class="radio-options-group">
                        <label class="radio-label">
                            <input type="radio" name="opsi_pengambilan" value="diambil_sendiri" checked>
                            <div class="custom-radio"></div>
                            <i class="fa-solid fa-store icon"></i>
                            <span>Diambil Sendiri</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="opsi_pengambilan" value="diantar">
                            <div class="custom-radio"></div>
                            <i class="fa-solid fa-truck icon"></i>
                            <span>Diantar</span>
                        </label>
                    </div>
                </div>
                <div id="alamat-group" class="form-group" style="display: none;">
                    <label for="alamat">Alamat Lengkap</label>
                    <textarea id="alamat" name="alamat" class="input-field"
                              placeholder="Masukkan jalan, kota, dan kode pos"></textarea>
                    <p class="error-message" id="alamat-error"></p>
                </div>
                <div class="form-group">
                    <label for="pesan">Pesan (Opsional)</label>
                    <textarea id="pesan" name="pesan" class="input-field"
                              placeholder="Tinggalkan catatan tambahan di sini jika ada..."></textarea>
                </div>

                <!-- Tombol Submit -->
                <div>
                    <button type="submit" class="btn btn-primary w-full">Kirim Pesanan</button>
                </div>
            </div>
        </form>
    </div>
</main>

<!-- Footer -->
<footer>
    <div class="footer-content">
        <div class="footer-column">
            <h3>Wiwid Bouquet</h3>
            <p>Merangkai cerita Anda dalam keindahan yang tak terlupakan. Temukan buket yang bukan hanya indah
                dipandang, tapi juga hangat di hati.</p>
        </div>
        <div class="footer-column">
            <h3>Hubungi Kami</h3>
            <ul class="footer-links">
                <li><a href="https://maps.app.goo.gl/8B63tYUqgUX9niEn7" target="_blank"><i
                        class="fa-solid fa-location-dot"></i><span>Jl. Raya Talok, Garum, Blitar</span></a></li>
                <li><a href="tel:+6285736834477"><i class="fa-solid fa-phone"></i><span>+62 857-3683-4477</span></a>
                </li>
                <li><a href="https://www.instagram.com/wiwidbeauty/" target="_blank"><i
                        class="fab fa-instagram"></i><span>@wiwidbeauty</span></a></li>
            </ul>
        </div>
    </div>
    <div class="copyright">
        <p>&copy; 2025 Wiwid Bouquet. Hak Cipta Dilindungi.</p>
    </div>
</footer>

<script>
    function capitalizeName(input) {
        input.value = input.value.replace(/\b\w/g, char => char.toUpperCase());
    }

    function formatPhoneNumber(input) {
        let value = input.value.replace(/\D/g, '');
        if (value.startsWith('0')) {
            value = value.substring(1);
        }
        value = value.substring(0, 12);
        if (value.length > 7) {
            value = value.replace(/(\d{3})(\d{4})(\d{1,5})/, '$1-$2-$3');
        } else if (value.length > 3) {
            value = value.replace(/(\d{3})(\d{1,4})/, '$1-$2');
        }
        input.value = value;
    }

    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('tanggal-acara').min = tomorrow.toISOString().split("T")[0];

    const kategoriSelect = document.getElementById('kategori_barang');
    const jenisBuketGroup = document.getElementById('jenis_buket_group');
    const jenisBuketLabel = jenisBuketGroup.querySelector('label');
    const jenisBuketSelect = document.getElementById('jenis_buket');
    const hargaMulaiSelect = document.getElementById('harga_mulai');
    const ukuranGroup = document.getElementById('ukuran_group');
    const nuansaWarnaGroup = document.getElementById('nuansa_warna_group');

    const optionsData = {
        'Buket Bunga': {
            label: 'Jenis Buket',
            jenis: ['Buket Wisuda', 'Buket Ulang Tahun', 'Buket Anniversary'],
            harga: {
                '15000-50000': 'Rp 15.000 - Rp 50.000', '100000': 'Rp 100.000', '150000': 'Rp 150.000',
                '200000': 'Rp 200.000', '250000': 'Rp 250.000', '350000': 'Rp 350.000', '500000': 'Rp 500.000'
            },
            showUkuran: true,
            showNuansa: true
        },
        'Buket Balon': {
            label: 'Jenis Buket Balon',
            jenis: ['Balon Karakter', 'Balon Angka/Huruf', 'Balon Custom'],
            harga: {
                '150000-185000': 'Rp 150.000 - Rp 185.000'
            },
            showUkuran: false,
            showNuansa: true
        },
        'Hampers': {
            label: 'Jenis Hampers',
            jenis: ['Hampers Lebaran', 'Hampers Natal', 'Hampers Makanan Ringan'],
            harga: {
                '100000': 'Rp 100.000', '250000': 'Rp 250.000', '500000': 'Rp 500.000'
            },
            showUkuran: false,
            showNuansa: false
        }
    };

    function updateFormFields(category) {
        const config = optionsData[category];
        if (!config) return;

        jenisBuketLabel.textContent = config.label;
        jenisBuketSelect.innerHTML = '<option value="" disabled selected>Pilih Jenis...</option>';
        config.jenis.forEach(opt => {
            const option = document.createElement('option');
            option.value = opt;
            option.textContent = opt;
            jenisBuketSelect.appendChild(option);
        });

        hargaMulaiSelect.innerHTML = '<option value="" disabled selected>Pilih Kategori Harga</option>';
        Object.entries(config.harga).forEach(([value, text]) => {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = text;
            hargaMulaiSelect.appendChild(option);
        });

        ukuranGroup.style.display = config.showUkuran ? 'block' : 'none';
        nuansaWarnaGroup.style.display = config.showNuansa ? 'block' : 'none';
    }

    kategoriSelect.addEventListener('change', (e) => {
        updateFormFields(e.target.value);
    });

    updateFormFields(kategoriSelect.value || 'Buket Bunga');

    const dropZone = document.getElementById('drop-zone');
    const fileUpload = document.getElementById('file-upload');
    const previewContainer = document.getElementById('preview-container');
    const uploadPrompt = document.getElementById('upload-prompt');
    let uploadedFiles = [];

    if (dropZone) {
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.add('border-indigo-600', 'bg-indigo-50'), false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.remove('border-indigo-600', 'bg-indigo-50'), false);
        });
        dropZone.addEventListener('drop', handleDrop, false);
        fileUpload.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
    }

    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }

    function handleDrop(e) {
        handleFiles(e.dataTransfer.files);
    }

    function handleFiles(files) {
        uploadedFiles = uploadedFiles.concat(Array.from(files));
        renderPreviews();
        updateFileInput();
    }

    function renderPreviews() {
        uploadPrompt.style.display = uploadedFiles.length > 0 ? 'none' : 'block';
        previewContainer.innerHTML = '';
        uploadedFiles.forEach((file, index) => {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const div = document.createElement('div');
                    div.className = 'preview-item';
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = "preview-img";
                    div.appendChild(img);
                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.innerHTML = '&times;';
                    removeBtn.className = 'delete-btn';
                    removeBtn.title = 'Hapus gambar';
                    removeBtn.onclick = () => {
                        uploadedFiles.splice(index, 1);
                        renderPreviews();
                        updateFileInput();
                    };
                    div.appendChild(removeBtn);
                    previewContainer.appendChild(div);
                };
                reader.readAsDataURL(file);
            }
        });
    }

    function updateFileInput() {
        const dataTransfer = new DataTransfer();
        uploadedFiles.forEach(file => dataTransfer.items.add(file));
        fileUpload.files = dataTransfer.files;
    }

    const pickupOptions = document.querySelectorAll('input[name="opsi_pengambilan"]');
    const alamatGroup = document.getElementById('alamat-group');
    const alamatTextarea = document.getElementById('alamat');

    pickupOptions.forEach(option => {
        option.addEventListener('change', (e) => {
            if (e.target.value === 'diantar') {
                alamatGroup.style.display = 'block';
                alamatTextarea.required = true;
            } else {
                alamatGroup.style.display = 'none';
                alamatTextarea.required = false;
            }
        });
    });

    const form = document.getElementById('orderForm');

    function showError(element, message) {
        const errorElement = document.getElementById(`${element.id}-error`);
        if (errorElement) {
            errorElement.textContent = message;
            errorElement.style.display = 'block';
        }
        if (element.id === 'whatsappNumber') {
            document.getElementById('whatsapp-group').classList.add('input-error');
        } else {
            element.classList.add('input-error');
        }
    }

    function clearError(element) {
        const errorElement = document.getElementById(`${element.id}-error`);
        if (errorElement) {
            errorElement.textContent = '';
            errorElement.style.display = 'none';
        }
        if (element.id === 'whatsappNumber') {
            document.getElementById('whatsapp-group').classList.remove('input-error');
        } else {
            element.classList.remove('input-error');
        }
    }

    form.addEventListener('submit', function (e) {
        e.preventDefault();
        let isValid = true;
        let firstInvalidElement = null;

        document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
        document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));

        const fieldsToValidate = [
            {element: form.fullName, message: 'Nama lengkap tidak boleh kosong.'},
            {element: form.whatsappNumber, message: 'Nomor WhatsApp tidak boleh kosong.'},
            {element: form.kategori_barang, message: 'Kategori produk harus dipilih.'},
            {element: form.jenis_buket, message: 'Jenis produk harus dipilih.'},
            {
                element: form.jumlah_pesanan,
                message: 'Jumlah pesanan tidak boleh nol atau kurang.',
                condition: (el) => parseInt(el.value, 10) <= 0
            },
            {element: form['tanggal-acara'], message: 'Tanggal acara harus diisi.'},
            {
                element: form.ukuran,
                message: 'Ukuran harus dipilih.',
                condition: (el) => ukuranGroup.style.display !== 'none' && !el.value
            },
            {
                element: form.alamat,
                message: 'Alamat lengkap tidak boleh kosong saat memilih opsi diantar.',
                condition: (el) => document.querySelector('input[name="opsi_pengambilan"]:checked').value === 'diantar' && !el.value.trim()
            }
        ];

        fieldsToValidate.forEach(field => {
            const condition = field.condition ? field.condition(field.element) : !field.element.value.trim();
            if (condition) {
                showError(field.element, field.message);
                isValid = false;
                if (!firstInvalidElement) {
                    firstInvalidElement = field.element;
                }
            }
        });

        if (!isValid && firstInvalidElement) {
            firstInvalidElement.scrollIntoView({behavior: 'smooth', block: 'center'});
        } else if (isValid) {
            alert('Form valid! Siap untuk dikirim.');
        }
    });

    form.querySelectorAll('input, select, textarea').forEach(input => {
        input.addEventListener('input', () => clearError(input));
    });

</script>

</body>
</html>
